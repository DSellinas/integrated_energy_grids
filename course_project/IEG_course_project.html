
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Course project &#8212; integrated-energy-grids</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'course_project/IEG_course_project';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Problem 3.2" href="../Problems/Problem03.02.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/DTUlogo.jpg" class="logo__image only-light" alt="integrated-energy-grids - Home"/>
    <img src="../_static/DTUlogo.jpg" class="logo__image only-dark pst-js-only" alt="integrated-energy-grids - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../intro-install.html">Python and Conda</a></li>







<li class="toctree-l1"><a class="reference internal" href="../intro-python.html">Introduction to <code class="docutils literal notranslate"><span class="pre">Python</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro-numpy.html">Introduction to <code class="docutils literal notranslate"><span class="pre">numpy</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro-matplotlib.html">Introduction to <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro-pandas.html">Introduction to <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../Problems/Problem01.01.html">Problem 1.1</a></li>

<li class="toctree-l1"><a class="reference internal" href="../Problems/Problem01.01b.html">Problem 1.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Problems/Problem01.03.html">Problem 1.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Problems/Problem01.04.html">Problem 1.4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Problems/Problem01.05.html">Problem 1.5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Problems/Problem03.01.html">Problem 3.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Problems/Problem03.02.html">Problem 3.2</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Course project</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/martavp/integrated-energy-grids/blob/main/integrated-energy-grids/course_project/IEG_course_project.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/martavp/integrated-energy-grids" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/martavp/integrated-energy-grids/issues/new?title=Issue%20on%20page%20%2Fcourse_project/IEG_course_project.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/course_project/IEG_course_project.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Course project</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Course project</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#project-instructions">PROJECT INSTRUCTIONS</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hints">Hints</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="course-project">
<h1>Course project<a class="headerlink" href="#course-project" title="Link to this heading">#</a></h1>
<p>This notebook includes the steps to optimize the capacity and dispatch of generators in the power system of one country.
Make sure that you understand every step in this notebook. For the (optional) project of the course ‘Integrated Energy Grids’ you need to deliver a report including the sections described at the end of this notebook.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have not yet set up Python on your computer, you can execute this tutorial in your browser via <a class="reference external" href="https://colab.research.google.com/">Google Colab</a>. Click on the rocket in the top right corner and launch “Colab”. If that doesn’t work download the <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code> file and import it in <a class="reference external" href="https://colab.research.google.com/">Google Colab</a>.</p>
<p>Then install <code class="docutils literal notranslate"><span class="pre">pandas</span></code> and <code class="docutils literal notranslate"><span class="pre">numpy</span></code> by executing the following command in a Jupyter cell at the top of the notebook.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>!pip<span class="w"> </span>install<span class="w"> </span>pandas<span class="w"> </span>pypsa
</pre></div>
</div>
</div>
<p>Pandas package is very useful to work with imported data, time series, matrices …</p>
<p>You can find a 10-minutes guide to pandas in the following link
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html">https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pypsa
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pypsa</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pypsa in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (0.32.0)
Requirement already satisfied: numpy in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from pypsa) (1.26.4)
Requirement already satisfied: scipy in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from pypsa) (1.14.1)
Requirement already satisfied: pandas&gt;=0.24 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from pypsa) (2.2.3)
Requirement already satisfied: xarray in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from pypsa) (2024.11.0)
Requirement already satisfied: netcdf4 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from pypsa) (1.7.2)
Requirement already satisfied: linopy&gt;=0.4 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from pypsa) (0.4.3)
Requirement already satisfied: matplotlib in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from pypsa) (3.10.0)
Requirement already satisfied: geopandas&gt;=0.9 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from pypsa) (1.0.1)
Requirement already satisfied: networkx&gt;=2 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from pypsa) (3.4.2)
Requirement already satisfied: deprecation in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from pypsa) (2.1.0)
Requirement already satisfied: validators in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from pypsa) (0.34.0)
Requirement already satisfied: highspy in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from pypsa) (1.8.1)
Requirement already satisfied: pyogrio&gt;=0.7.2 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from geopandas&gt;=0.9-&gt;pypsa) (0.10.0)
Requirement already satisfied: packaging in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from geopandas&gt;=0.9-&gt;pypsa) (24.2)
Requirement already satisfied: pyproj&gt;=3.3.0 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from geopandas&gt;=0.9-&gt;pypsa) (3.7.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: shapely&gt;=2.0.0 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from geopandas&gt;=0.9-&gt;pypsa) (2.0.6)
Requirement already satisfied: bottleneck in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from linopy&gt;=0.4-&gt;pypsa) (1.4.2)
Requirement already satisfied: toolz in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from linopy&gt;=0.4-&gt;pypsa) (1.0.0)
Requirement already satisfied: numexpr in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from linopy&gt;=0.4-&gt;pypsa) (2.10.2)
Requirement already satisfied: dask&gt;=0.18.0 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from linopy&gt;=0.4-&gt;pypsa) (2024.12.1)
Requirement already satisfied: polars in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from linopy&gt;=0.4-&gt;pypsa) (1.17.1)
Requirement already satisfied: tqdm in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from linopy&gt;=0.4-&gt;pypsa) (4.67.1)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from pandas&gt;=0.24-&gt;pypsa) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from pandas&gt;=0.24-&gt;pypsa) (2024.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from pandas&gt;=0.24-&gt;pypsa) (2024.2)
Requirement already satisfied: contourpy&gt;=1.0.1 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from matplotlib-&gt;pypsa) (1.3.1)
Requirement already satisfied: cycler&gt;=0.10 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from matplotlib-&gt;pypsa) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from matplotlib-&gt;pypsa) (4.55.3)
Requirement already satisfied: kiwisolver&gt;=1.3.1 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from matplotlib-&gt;pypsa) (1.4.7)
Requirement already satisfied: pillow&gt;=8 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from matplotlib-&gt;pypsa) (11.0.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from matplotlib-&gt;pypsa) (3.2.0)
Requirement already satisfied: cftime in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from netcdf4-&gt;pypsa) (1.6.4.post1)
Requirement already satisfied: certifi in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from netcdf4-&gt;pypsa) (2024.12.14)
Requirement already satisfied: click&gt;=8.1 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from dask&gt;=0.18.0-&gt;linopy&gt;=0.4-&gt;pypsa) (8.1.7)
Requirement already satisfied: cloudpickle&gt;=3.0.0 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from dask&gt;=0.18.0-&gt;linopy&gt;=0.4-&gt;pypsa) (3.1.0)
Requirement already satisfied: fsspec&gt;=2021.09.0 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from dask&gt;=0.18.0-&gt;linopy&gt;=0.4-&gt;pypsa) (2024.10.0)
Requirement already satisfied: partd&gt;=1.4.0 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from dask&gt;=0.18.0-&gt;linopy&gt;=0.4-&gt;pypsa) (1.4.2)
Requirement already satisfied: pyyaml&gt;=5.3.1 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from dask&gt;=0.18.0-&gt;linopy&gt;=0.4-&gt;pypsa) (6.0.2)
Requirement already satisfied: importlib_metadata&gt;=4.13.0 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from dask&gt;=0.18.0-&gt;linopy&gt;=0.4-&gt;pypsa) (8.5.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: six&gt;=1.5 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&gt;=0.24-&gt;pypsa) (1.17.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: zipp&gt;=3.20 in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from importlib_metadata&gt;=4.13.0-&gt;dask&gt;=0.18.0-&gt;linopy&gt;=0.4-&gt;pypsa) (3.21.0)
Requirement already satisfied: locket in /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages (from partd&gt;=1.4.0-&gt;dask&gt;=0.18.0-&gt;linopy&gt;=0.4-&gt;pypsa) (1.0.0)
</pre></div>
</div>
</div>
</div>
<p>We start by creating the network. In this example, the country is modelled as a single node, so the network will only include one bus.</p>
<p>We select the year 2015 and set the hours in that year as snapshots.</p>
<p>We select a country, in this case Spain (ESP), and add one node (electricity bus) to the network.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span> <span class="o">=</span> <span class="n">pypsa</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span>
<span class="n">hours_in_2015</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2015-01-01T00:00Z&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;2015-12-31T23:00Z&#39;</span><span class="p">,</span>
                              <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>

<span class="n">network</span><span class="o">.</span><span class="n">set_snapshots</span><span class="p">(</span><span class="n">hours_in_2015</span><span class="p">)</span>

<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Bus&quot;</span><span class="p">,</span><span class="s2">&quot;electricity bus&quot;</span><span class="p">)</span>

<span class="n">network</span><span class="o">.</span><span class="n">snapshots</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">6</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">network</span> <span class="o">=</span> <span class="n">pypsa</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">hours_in_2015</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2015-01-01T00:00Z&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>                               <span class="s1">&#39;2015-12-31T23:00Z&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>                               <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="n">network</span><span class="o">.</span><span class="n">set_snapshots</span><span class="p">(</span><span class="n">hours_in_2015</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Bus&quot;</span><span class="p">,</span><span class="s2">&quot;electricity bus&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="n">network</span><span class="o">.</span><span class="n">snapshots</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages/pypsa/components.py:685,</span> in <span class="ni">Network.set_snapshots</span><span class="nt">(self, snapshots, default_snapshot_weightings, weightings_from_timedelta)</span>
<span class="g g-Whitespace">    </span><span class="mi">679</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="ow">and</span> <span class="n">snapshots</span><span class="o">.</span><span class="n">tz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">680</span>     <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">681</span>         <span class="s2">&quot;Numpy datetime64[ns] objects with timezones are not supported and are &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">682</span>         <span class="s2">&quot;thus not allowed in snapshots. Please pass timezone-naive timestamps &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">683</span>         <span class="s2">&quot;(e.g. via ds.values).&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">684</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">685</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">687</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">688</span>     <span class="k">if</span> <span class="n">snapshots</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>

<span class="ne">ValueError</span>: Numpy datetime64[ns] objects with timezones are not supported and are thus not allowed in snapshots. Please pass timezone-naive timestamps (e.g. via ds.values).
</pre></div>
</div>
</div>
</div>
<p>The demand is represented by the historical electricity demand in 2015 with hourly resolution.</p>
<p>The file with historical hourly electricity demand for every European country is available in the data folder.</p>
<p>The electricity demand time series were obtained from ENTSOE through the very convenient compilation carried out by the Open Power System Data (OPSD). <a class="reference external" href="https://data.open-power-system-data.org/time_series/">https://data.open-power-system-data.org/time_series/</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load electricity demand data</span>
<span class="n">df_elec</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/electricity_demand.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># in MWh</span>
<span class="n">df_elec</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_elec</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="c1">#change index to datatime</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_elec</span><span class="p">[</span><span class="s1">&#39;ESP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>utc_time
2015-01-01 00:00:00+00:00    24382.0
2015-01-01 01:00:00+00:00    22734.0
2015-01-01 02:00:00+00:00    21286.0
2015-01-01 03:00:00+00:00    20264.0
2015-01-01 04:00:00+00:00    19905.0
Name: ESP, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add load to the bus</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Load&quot;</span><span class="p">,</span>
            <span class="s2">&quot;load&quot;</span><span class="p">,</span>
            <span class="n">bus</span><span class="o">=</span><span class="s2">&quot;electricity bus&quot;</span><span class="p">,</span>
            <span class="n">p_set</span><span class="o">=</span><span class="n">df_elec</span><span class="p">[</span><span class="s1">&#39;ESP&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Print the load time series to check that it has been properly added (you should see numbers and not ‘NaN’)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">loads_t</span><span class="o">.</span><span class="n">p_set</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Load</th>
      <th>load</th>
    </tr>
    <tr>
      <th>snapshot</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-01-01 00:00:00+00:00</th>
      <td>24382.0</td>
    </tr>
    <tr>
      <th>2015-01-01 01:00:00+00:00</th>
      <td>22734.0</td>
    </tr>
    <tr>
      <th>2015-01-01 02:00:00+00:00</th>
      <td>21286.0</td>
    </tr>
    <tr>
      <th>2015-01-01 03:00:00+00:00</th>
      <td>20264.0</td>
    </tr>
    <tr>
      <th>2015-01-01 04:00:00+00:00</th>
      <td>19905.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>2015-12-31 19:00:00+00:00</th>
      <td>28653.0</td>
    </tr>
    <tr>
      <th>2015-12-31 20:00:00+00:00</th>
      <td>27078.0</td>
    </tr>
    <tr>
      <th>2015-12-31 21:00:00+00:00</th>
      <td>24565.0</td>
    </tr>
    <tr>
      <th>2015-12-31 22:00:00+00:00</th>
      <td>23311.0</td>
    </tr>
    <tr>
      <th>2015-12-31 23:00:00+00:00</th>
      <td>22431.0</td>
    </tr>
  </tbody>
</table>
<p>8760 rows × 1 columns</p>
</div></div></div>
</div>
<p>In the optimization, we will minimize the annualized system costs.</p>
<p>We will need to annualize the cost of every generator, we build a function to do it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">annuity</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the annuity factor for an asset with lifetime n years and</span>
<span class="sd">    discount rate of r, e.g. annuity(20,0.05)*20 = 1.6&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">r</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="n">n</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">n</span>
</pre></div>
</div>
</div>
</div>
<p>We include solar PV and onshore wind generators.</p>
<p>The capacity factors representing the availability of those generators for every European country can be downloaded from the following repositories (select ‘optimal’ for PV and onshore for wind).</p>
<p><a class="reference external" href="https://zenodo.org/record/3253876#.XSiVOEdS8l0">https://zenodo.org/record/3253876#.XSiVOEdS8l0</a></p>
<p><a class="reference external" href="https://zenodo.org/record/2613651#.XSiVOkdS8l0">https://zenodo.org/record/2613651#.XSiVOkdS8l0</a></p>
<p>We include also Open Cycle Gas Turbine (OCGT) generators</p>
<p>The cost assumed for the generators are the same as in the paper <a class="reference external" href="https://doi.org/10.1016/j.enconman.2019.111977">https://doi.org/10.1016/j.enconman.2019.111977</a> (open version:  <a class="reference external" href="https://arxiv.org/pdf/1906.06936.pdf">https://arxiv.org/pdf/1906.06936.pdf</a>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add the different carriers, only gas emits CO2</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Carrier&quot;</span><span class="p">,</span> <span class="s2">&quot;gas&quot;</span><span class="p">,</span> <span class="n">co2_emissions</span><span class="o">=</span><span class="mf">0.19</span><span class="p">)</span> <span class="c1"># in t_CO2/MWh_th</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Carrier&quot;</span><span class="p">,</span> <span class="s2">&quot;onshorewind&quot;</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Carrier&quot;</span><span class="p">,</span> <span class="s2">&quot;solar&quot;</span><span class="p">)</span>

<span class="c1"># add onshore wind generator</span>
<span class="n">df_onshorewind</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_extra/onshore_wind_1979-2017.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_onshorewind</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_onshorewind</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">CF_wind</span> <span class="o">=</span> <span class="n">df_onshorewind</span><span class="p">[</span><span class="s1">&#39;ESP&#39;</span><span class="p">][[</span><span class="n">hour</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%SZ&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">hour</span> <span class="ow">in</span> <span class="n">network</span><span class="o">.</span><span class="n">snapshots</span><span class="p">]]</span>
<span class="n">capital_cost_onshorewind</span> <span class="o">=</span> <span class="n">annuity</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mf">0.07</span><span class="p">)</span><span class="o">*</span><span class="mi">910000</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.033</span><span class="p">)</span> <span class="c1"># in €/MW</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Generator&quot;</span><span class="p">,</span>
            <span class="s2">&quot;onshorewind&quot;</span><span class="p">,</span>
            <span class="n">bus</span><span class="o">=</span><span class="s2">&quot;electricity bus&quot;</span><span class="p">,</span>
            <span class="n">p_nom_extendable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">carrier</span><span class="o">=</span><span class="s2">&quot;onshorewind&quot;</span><span class="p">,</span>
            <span class="c1">#p_nom_max=1000, # maximum capacity can be limited due to environmental constraints</span>
            <span class="n">capital_cost</span> <span class="o">=</span> <span class="n">capital_cost_onshorewind</span><span class="p">,</span>
            <span class="n">marginal_cost</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">p_max_pu</span> <span class="o">=</span> <span class="n">CF_wind</span><span class="p">)</span>

<span class="c1"># add solar PV generator</span>
<span class="n">df_solar</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_extra/pv_optimal.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_solar</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_solar</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">CF_solar</span> <span class="o">=</span> <span class="n">df_solar</span><span class="p">[</span><span class="s1">&#39;ESP&#39;</span><span class="p">][[</span><span class="n">hour</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%SZ&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">hour</span> <span class="ow">in</span> <span class="n">network</span><span class="o">.</span><span class="n">snapshots</span><span class="p">]]</span>
<span class="n">capital_cost_solar</span> <span class="o">=</span> <span class="n">annuity</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mf">0.07</span><span class="p">)</span><span class="o">*</span><span class="mi">425000</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.03</span><span class="p">)</span> <span class="c1"># in €/MW</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Generator&quot;</span><span class="p">,</span>
            <span class="s2">&quot;solar&quot;</span><span class="p">,</span>
            <span class="n">bus</span><span class="o">=</span><span class="s2">&quot;electricity bus&quot;</span><span class="p">,</span>
            <span class="n">p_nom_extendable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">carrier</span><span class="o">=</span><span class="s2">&quot;solar&quot;</span><span class="p">,</span>
            <span class="c1">#p_nom_max=1000, # maximum capacity can be limited due to environmental constraints</span>
            <span class="n">capital_cost</span> <span class="o">=</span> <span class="n">capital_cost_solar</span><span class="p">,</span>
            <span class="n">marginal_cost</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">p_max_pu</span> <span class="o">=</span> <span class="n">CF_solar</span><span class="p">)</span>

<span class="c1"># add OCGT (Open Cycle Gas Turbine) generator</span>
<span class="n">capital_cost_OCGT</span> <span class="o">=</span> <span class="n">annuity</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mf">0.07</span><span class="p">)</span><span class="o">*</span><span class="mi">560000</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.033</span><span class="p">)</span> <span class="c1"># in €/MW</span>
<span class="n">fuel_cost</span> <span class="o">=</span> <span class="mf">21.6</span> <span class="c1"># in €/MWh_th</span>
<span class="n">efficiency</span> <span class="o">=</span> <span class="mf">0.39</span>
<span class="n">marginal_cost_OCGT</span> <span class="o">=</span> <span class="n">fuel_cost</span><span class="o">/</span><span class="n">efficiency</span> <span class="c1"># in €/MWh_el</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Generator&quot;</span><span class="p">,</span>
            <span class="s2">&quot;OCGT&quot;</span><span class="p">,</span>
            <span class="n">bus</span><span class="o">=</span><span class="s2">&quot;electricity bus&quot;</span><span class="p">,</span>
            <span class="n">p_nom_extendable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">carrier</span><span class="o">=</span><span class="s2">&quot;gas&quot;</span><span class="p">,</span>
            <span class="c1">#p_nom_max=1000,</span>
            <span class="n">capital_cost</span> <span class="o">=</span> <span class="n">capital_cost_OCGT</span><span class="p">,</span>
            <span class="n">marginal_cost</span> <span class="o">=</span> <span class="n">marginal_cost_OCGT</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Print the generator Capacity factor time series to check that it has been properly added (you should see numbers and not ‘NaN’)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p_max_pu</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Generator</th>
      <th>onshorewind</th>
      <th>solar</th>
    </tr>
    <tr>
      <th>snapshot</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-01-01 00:00:00+00:00</th>
      <td>0.152</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2015-01-01 01:00:00+00:00</th>
      <td>0.141</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2015-01-01 02:00:00+00:00</th>
      <td>0.131</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2015-01-01 03:00:00+00:00</th>
      <td>0.115</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2015-01-01 04:00:00+00:00</th>
      <td>0.101</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2015-12-31 19:00:00+00:00</th>
      <td>0.085</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2015-12-31 20:00:00+00:00</th>
      <td>0.079</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2015-12-31 21:00:00+00:00</th>
      <td>0.076</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2015-12-31 22:00:00+00:00</th>
      <td>0.079</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2015-12-31 23:00:00+00:00</th>
      <td>0.084</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>8760 rows × 2 columns</p>
</div></div></div>
</div>
<p>We find the optimal solution using Gurobi as solver.</p>
<p>In this case, we are optimising the installed capacity and dispatch of every generator to minimize the total system cost.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s1">&#39;gurobi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.model: Solve problem using Gurobi solver
Writing constraints.: 100%|███████████████████████| 5/5 [00:01&lt;00:00,  3.22it/s]
Writing continuous variables.: 100%|██████████████| 2/2 [00:00&lt;00:00,  5.01it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Read LP format model from file /tmp/linopy-problem-pqev7i0x.lp
Reading time = 0.32 seconds
obj: 61323 rows, 26283 columns, 100923 nonzeros
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Core(TM) i7-8550U CPU @ 1.80GHz, instruction set [SSE2|AVX|AVX2]
Thread count: 1 physical cores, 1 logical processors, using up to 1 threads

Optimize a model with 61323 rows, 26283 columns and 100923 nonzeros
Model fingerprint: 0xd9170e45
Coefficient statistics:
  Matrix range     [1e-03, 1e+00]
  Objective range  [6e+01, 8e+04]
  Bounds range     [0e+00, 0e+00]
  RHS range        [2e+04, 4e+04]
Presolve removed 34683 rows and 8400 columns
Presolve time: 0.20s
Presolved: 26640 rows, 17883 columns, 57840 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    6.1132405e+09   3.106213e+07   0.000000e+00      0s
    8656    1.2852241e+10   0.000000e+00   0.000000e+00      2s

Solved in 8656 iterations and 2.34 seconds (2.56 work units)
Optimal objective  1.285224132e+10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.constants: Optimization successful: 
Status: ok
Termination condition: optimal
Solution: 26283 primals, 61323 duals
Objective: 1.29e+10
Solver model: available
Solver message: 2

INFO:pypsa.optimization.optimize:The shadow-prices of the constraints Generator-ext-p-lower, Generator-ext-p-upper were not assigned to the network.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;ok&#39;, &#39;optimal&#39;)
</pre></div>
</div>
</div>
</div>
<p>The message (‘ok’ , ‘optimal”) indicates that the optimizer has found an optimal solution.</p>
<p>The total cost can be read from the network objetive.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">objective</span><span class="o">/</span><span class="mi">1000000</span><span class="p">)</span> <span class="c1">#in 10^6 €</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12852.241324554236
</pre></div>
</div>
</div>
</div>
<p>The cost per MWh of electricity produced can also be calculated.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">objective</span><span class="o">/</span><span class="n">network</span><span class="o">.</span><span class="n">loads_t</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="c1"># €/MWh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Load
load    51.719905
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The optimal capacity for every generator can be shown.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">generators</span><span class="o">.</span><span class="n">p_nom_opt</span> <span class="c1"># in MW</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generator
onshorewind    48793.402778
solar          38809.596688
OCGT           36924.371528
Name: p_nom_opt, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We can plot now the dispatch of every generator during the first week of the year and the electricity demand.
We import the matplotlib package which is very useful to plot results.</p>
<p>We can also plot the electricity mix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">loads_t</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;load&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">96</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;demand&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;onshorewind&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">96</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;onshore wind&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;solar&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">96</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;solar&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;OCGT&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">96</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;gas (OCGT)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f124ed5bdc0&gt;
</pre></div>
</div>
<img alt="../_images/08bed806d2a3f909e59f20d0d55dc9806df9ed74b13d2bd5e360a5b0397c5c37.png" src="../_images/08bed806d2a3f909e59f20d0d55dc9806df9ed74b13d2bd5e360a5b0397c5c37.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;onshore wind&#39;</span><span class="p">,</span>
          <span class="s1">&#39;solar&#39;</span><span class="p">,</span>
          <span class="s1">&#39;gas (OCGT)&#39;</span><span class="p">]</span>
<span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;onshorewind&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
         <span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;solar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
         <span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;OCGT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()]</span>

<span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
        <span class="n">wedgeprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Electricity mix&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.07</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.07, &#39;Electricity mix&#39;)
</pre></div>
</div>
<img alt="../_images/0bae28dcc5bc9b5d10ab9a8ec0d51c20c83767da6e3bb2cab0460779ed319a79.png" src="../_images/0bae28dcc5bc9b5d10ab9a8ec0d51c20c83767da6e3bb2cab0460779ed319a79.png" />
</div>
</div>
<p>We can add a global CO2 constraint and solve again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_limit</span><span class="o">=</span><span class="mi">4000000</span> <span class="c1">#tonCO2</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;GlobalConstraint&quot;</span><span class="p">,</span>
            <span class="s2">&quot;co2_limit&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;primary_energy&quot;</span><span class="p">,</span>
            <span class="n">carrier_attribute</span><span class="o">=</span><span class="s2">&quot;co2_emissions&quot;</span><span class="p">,</span>
            <span class="n">sense</span><span class="o">=</span><span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span>
            <span class="n">constant</span><span class="o">=</span><span class="n">co2_limit</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s1">&#39;gurobi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.model: Solve problem using Gurobi solver
Writing constraints.: 100%|███████████████████████| 6/6 [00:00&lt;00:00,  6.80it/s]
Writing continuous variables.: 100%|██████████████| 2/2 [00:00&lt;00:00,  7.07it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Read LP format model from file /tmp/linopy-problem-n8eoys00.lp
Reading time = 0.37 seconds
obj: 61324 rows, 26283 columns, 109683 nonzeros
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Core(TM) i7-8550U CPU @ 1.80GHz, instruction set [SSE2|AVX|AVX2]
Thread count: 1 physical cores, 1 logical processors, using up to 1 threads

Optimize a model with 61324 rows, 26283 columns and 109683 nonzeros
Model fingerprint: 0x30c689aa
Coefficient statistics:
  Matrix range     [1e-03, 1e+00]
  Objective range  [6e+01, 8e+04]
  Bounds range     [0e+00, 0e+00]
  RHS range        [2e+04, 4e+06]
Presolve removed 34683 rows and 8400 columns
Presolve time: 0.21s
Presolved: 26641 rows, 17883 columns, 66600 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    6.1132405e+09   6.183118e+07   0.000000e+00      0s
    3693    1.8097276e+10   1.547710e+06   0.000000e+00      5s
    4595    1.8448556e+10   0.000000e+00   0.000000e+00      6s

Solved in 4595 iterations and 6.01 seconds (9.73 work units)
Optimal objective  1.844855565e+10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:linopy.constants: Optimization successful: 
Status: ok
Termination condition: optimal
Solution: 26283 primals, 61324 duals
Objective: 1.84e+10
Solver model: available
Solver message: 2

INFO:pypsa.optimization.optimize:The shadow-prices of the constraints Generator-ext-p-lower, Generator-ext-p-upper were not assigned to the network.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;ok&#39;, &#39;optimal&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">generators</span><span class="o">.</span><span class="n">p_nom_opt</span> <span class="c1">#in MW</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generator
onshorewind    190147.670808
solar           32683.511351
OCGT            33249.160559
Name: p_nom_opt, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">loads_t</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;load&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">96</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;demand&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;onshorewind&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">96</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;onshore wind&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;solar&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">96</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;solar&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;OCGT&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">96</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;gas (OCGT)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f124cd74df0&gt;
</pre></div>
</div>
<img alt="../_images/112b7081bc1ee0f7037adcab6360cac7774ee4c202de7acd94702509ce1de67a.png" src="../_images/112b7081bc1ee0f7037adcab6360cac7774ee4c202de7acd94702509ce1de67a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;onshore wind&#39;</span><span class="p">,</span> <span class="s1">&#39;solar&#39;</span><span class="p">,</span> <span class="s1">&#39;gas (OCGT)&#39;</span> <span class="p">]</span>
<span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;onshorewind&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
         <span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;solar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
         <span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;OCGT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()]</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
        <span class="n">wedgeprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Electricity mix&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.07</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.07, &#39;Electricity mix&#39;)
</pre></div>
</div>
<img alt="../_images/86e24337ad1f5fd708c5879209797228ac5c8afa7fdd11ef273a1385c8e13017.png" src="../_images/86e24337ad1f5fd708c5879209797228ac5c8afa7fdd11ef273a1385c8e13017.png" />
</div>
</div>
<section id="project-instructions">
<h2>PROJECT INSTRUCTIONS<a class="headerlink" href="#project-instructions" title="Link to this heading">#</a></h2>
<p>Based on the previous example, you are asked to carry out the following tasks:</p>
<p>A. Choose a different country/region and calculate the optimal capacities for renewable and non-renewable generators. You can add as many technologies as you want. Remember to provide a reference for the cost assumptions. Plot the dispatch time series for a week in summer and winter. Plot the annual electricity mix. Use the duration curves or the capacity factor to investigate the contribution from different technologies.</p>
<p>B. Investigate how sensitive is the optimum capacity mix to the global CO2 constraint. E.g., plot the generation mix as a function of the CO2 constraint that you impose. Search for the CO2 emissions in your country (today or in 1990) and refer the emissions allowance to that historical data.</p>
<p>C. Investigate how sensitive are your results to the interannual variability of solar and wind generation. Plot the average capacity and variability obtained for every generator using different weather years.</p>
<p>D. Add some storage technology/ies and investigate how they behave and what are their impact on the optimal system configuration.</p>
<p>E. Discuss what strategies is your system using to balance the renewable generation at different time scales (intraday, seasonal, etc.)</p>
<p>F. Select one target for decarbonization (i.e., one CO2 allowance limit). What is the CO2 price required to achieve that decarbonization level? Search for information on the existing CO2 tax in your country (if any) and discuss your result.</p>
<p>G. Connect your country with, at least, two neighbour countries. You can assume that the capacities in the neighbours are fixed or cooptimize the whole system. You can also include fixed interconnection capacities or cooptimize them with the generators capacities. Discuss your results.</p>
<p>H. Connect the electricity sector with another sector such as heating or transport, and cooptimize the two sectors. Discuss your results.</p>
<p>I. Finally, select one topic that is under discussion in your region. Design and implement some experiment to obtain relevant information regarding that topic. E.g.</p>
<p>[-] What are the consequences if Denmark decides not to install more onshore wind?</p>
<p>[-] Would it be more expensive if France decides to close its nuclear power plants?</p>
<p>[-] What will be the main impacts of the Viking link?</p>
<p>[-] How does gas scarcity impact the optimal system configuration?</p>
<p>Write a short report (maximum 10 pages) including your main findings.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="hints">
<h1>Hints<a class="headerlink" href="#hints" title="Link to this heading">#</a></h1>
<p><em>TIP 1: You can add a link with the following code</em></p>
<p>The efficiency will be 1 if you are connecting two countries and different from one if, for example, you are connecting the electricity bus to the heating bus using a heat pump.
Setting p_min_pu=-1 makes the link reversible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span>
             <span class="s1">&#39;country a - country b&#39;</span><span class="p">,</span>
             <span class="n">bus0</span><span class="o">=</span><span class="s2">&quot;electricity bus country a&quot;</span><span class="p">,</span>
             <span class="n">bus1</span><span class="o">=</span><span class="s2">&quot;electricity bus country b&quot;</span><span class="p">,</span>
             <span class="n">p_nom_extendable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># capacity is optimised</span>
             <span class="n">p_min_pu</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">length</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="c1"># length (in km) between country a and country b</span>
             <span class="n">capital_cost</span><span class="o">=</span><span class="mi">400</span><span class="o">*</span><span class="mi">600</span><span class="p">)</span> <span class="c1"># capital cost * length</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:pypsa.components:The bus name `electricity bus country a` given for bus0 of Link `country a - country b` does not appear in network.buses
WARNING:pypsa.components:The bus name `electricity bus country b` given for bus1 of Link `country a - country b` does not appear in network.buses
</pre></div>
</div>
</div>
</div>
<p><em>TIP 2: You can check the KKT multiplier associated with the constraint with the following code</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">global_constraints</span><span class="o">.</span><span class="n">constant</span><span class="p">)</span> <span class="c1">#CO2 limit (constant in the constraint)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">global_constraints</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span> <span class="c1">#CO2 price (Lagrance multiplier in the constraint)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GlobalConstraint
co2_limit    4000000.0
Name: constant, dtype: float64
GlobalConstraint
co2_limit   -1426.947091
Name: mu, dtype: float64
</pre></div>
</div>
</div>
</div>
<p><em>TIP 3: You can add a H2 store connected to the electricity bus via an electrolyzer and a fuel cell with the following code</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Create a new carrier</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Carrier&quot;</span><span class="p">,</span>
      <span class="s2">&quot;H2&quot;</span><span class="p">)</span>

<span class="c1">#Create a new bus</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Bus&quot;</span><span class="p">,</span>
      <span class="s2">&quot;H2&quot;</span><span class="p">,</span>
      <span class="n">carrier</span> <span class="o">=</span> <span class="s2">&quot;H2&quot;</span><span class="p">)</span>

<span class="c1">#Connect the store to the bus</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Store&quot;</span><span class="p">,</span>
      <span class="s2">&quot;H2 Tank&quot;</span><span class="p">,</span>
      <span class="n">bus</span> <span class="o">=</span> <span class="s2">&quot;H2&quot;</span><span class="p">,</span>
      <span class="n">e_nom_extendable</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
      <span class="n">e_cyclic</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
      <span class="n">capital_cost</span> <span class="o">=</span> <span class="n">annuity</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">)</span><span class="o">*</span><span class="mi">57000</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.011</span><span class="p">))</span>

<span class="c1">#Add the link &quot;H2 Electrolysis&quot; that transport energy from the electricity bus (bus0) to the H2 bus (bus1)</span>
<span class="c1">#with 80% efficiency</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span>
      <span class="s2">&quot;H2 Electrolysis&quot;</span><span class="p">,</span>
      <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;electricity bus&quot;</span><span class="p">,</span>
      <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;H2&quot;</span><span class="p">,</span>
      <span class="n">p_nom_extendable</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
      <span class="n">efficiency</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
      <span class="n">capital_cost</span> <span class="o">=</span> <span class="n">annuity</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">)</span><span class="o">*</span><span class="mi">600000</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.05</span><span class="p">))</span>

<span class="c1">#Add the link &quot;H2 Fuel Cell&quot; that transports energy from the H2 bus (bus0) to the electricity bus (bus1)</span>
<span class="c1">#with 58% efficiency</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span>
      <span class="s2">&quot;H2 Fuel Cell&quot;</span><span class="p">,</span>
      <span class="n">bus0</span> <span class="o">=</span> <span class="s2">&quot;H2&quot;</span><span class="p">,</span>
      <span class="n">bus1</span> <span class="o">=</span> <span class="s2">&quot;electricity bus&quot;</span><span class="p">,</span>
      <span class="n">p_nom_extendable</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
      <span class="n">efficiency</span> <span class="o">=</span> <span class="mf">0.58</span><span class="p">,</span>
      <span class="n">capital_cost</span> <span class="o">=</span> <span class="n">annuity</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">)</span><span class="o">*</span><span class="mi">1300000</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.05</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p><em>TIP 4: Multi-node study</em></p>
<p>Let’s say that you are considering Denmark and want to add Norway and Sweden as neighbors.</p>
<p>Start by creating a new network (same procedure as before):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="n">pypsa</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span>
<span class="n">n</span><span class="o">.</span><span class="n">set_snapshots</span><span class="p">(</span><span class="n">hours_in_2015</span><span class="p">)</span>
<span class="n">n</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Carrier&quot;</span><span class="p">,</span> <span class="s2">&quot;gas&quot;</span><span class="p">,</span> <span class="n">co2_emissions</span><span class="o">=</span><span class="mf">0.19</span><span class="p">)</span> <span class="c1"># in t_CO2/MWh_th</span>
<span class="n">n</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Carrier&quot;</span><span class="p">,</span> <span class="s2">&quot;onshorewind&quot;</span><span class="p">)</span>
<span class="n">n</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Carrier&quot;</span><span class="p">,</span> <span class="s2">&quot;solar&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Define nodes and coordinates (used for plotting):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nodes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;DNK&#39;</span><span class="p">,</span><span class="s1">&#39;NOR&#39;</span><span class="p">,</span><span class="s1">&#39;SWE&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span>
<span class="n">neighbors</span> <span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;NOR&#39;</span><span class="p">,</span><span class="s1">&#39;SWE&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span>
<span class="n">c</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">neighbors</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># longitude</span>
<span class="n">xs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;DNK&#39;</span><span class="p">:</span><span class="mf">9.732249</span><span class="p">,</span>
     <span class="s1">&#39;NOR&#39;</span><span class="p">:</span><span class="mf">8.605318</span><span class="p">,</span>
     <span class="s1">&#39;SWE&#39;</span><span class="p">:</span><span class="mf">16.277634</span><span class="p">}</span>

<span class="c1"># latitude</span>
<span class="n">ys</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;DNK&#39;</span><span class="p">:</span><span class="mf">55.990430</span><span class="p">,</span>
     <span class="s1">&#39;NOR&#39;</span><span class="p">:</span><span class="mf">60.978911</span><span class="p">,</span>
     <span class="s1">&#39;SWE&#39;</span><span class="p">:</span><span class="mf">61.357761</span><span class="p">}</span>

<span class="n">n</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Bus&quot;</span><span class="p">,</span><span class="s1">&#39;DNK&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">[</span><span class="s1">&#39;DNK&#39;</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">ys</span><span class="p">[</span><span class="s1">&#39;DNK&#39;</span><span class="p">])</span>
<span class="n">n</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Bus&quot;</span><span class="p">,</span><span class="s1">&#39;NOR&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">[</span><span class="s1">&#39;NOR&#39;</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">ys</span><span class="p">[</span><span class="s1">&#39;NOR&#39;</span><span class="p">])</span>
<span class="n">n</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Bus&quot;</span><span class="p">,</span><span class="s1">&#39;SWE&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">[</span><span class="s1">&#39;SWE&#39;</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">ys</span><span class="p">[</span><span class="s1">&#39;SWE&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Now, let’s add the components (loads, links, generators) using the <em>‘network.madd’</em> command (instead of <em>‘network.add’</em>):</p>
<p>Loads:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">.</span><span class="n">madd</span><span class="p">(</span><span class="s2">&quot;Load&quot;</span><span class="p">,</span>
        <span class="n">nodes</span><span class="p">,</span>
        <span class="n">bus</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span>
        <span class="n">p_set</span><span class="o">=</span><span class="n">df_elec</span><span class="p">[</span><span class="n">nodes</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;DNK&#39;, &#39;NOR&#39;, &#39;SWE&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Links (interconnection):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Links from main country (c) to neighboring countries</span>
<span class="n">n</span><span class="o">.</span><span class="n">madd</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span>
     <span class="n">c</span> <span class="o">+</span> <span class="s2">&quot; - &quot;</span> <span class="o">+</span> <span class="n">neighbors</span><span class="p">,</span>
     <span class="n">bus0</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
     <span class="n">bus1</span><span class="o">=</span><span class="n">neighbors</span><span class="p">,</span>
     <span class="n">p_nom_extendable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># capacity is optimised</span>
     <span class="n">p_min_pu</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
     <span class="n">length</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="c1"># length (in km) between country a and country b</span>
     <span class="n">capital_cost</span><span class="o">=</span><span class="mi">400</span><span class="o">*</span><span class="mi">600</span><span class="p">)</span> <span class="c1"># capital cost [EUR/MW/km] * length [km]</span>

<span class="c1"># Links between neighboring countries</span>
<span class="n">n</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span>
     <span class="n">neighbors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="n">neighbors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
     <span class="n">bus0</span><span class="o">=</span><span class="n">neighbors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
     <span class="n">bus1</span><span class="o">=</span><span class="n">neighbors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
     <span class="n">p_nom_extendable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># capacity is optimised</span>
     <span class="n">p_min_pu</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
     <span class="n">length</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="c1"># length (in km) between country a and country b</span>
     <span class="n">capital_cost</span><span class="o">=</span><span class="mi">400</span><span class="o">*</span><span class="mi">600</span><span class="p">)</span> <span class="c1"># capital cost [EUR/MW/km] * length [km]</span>
</pre></div>
</div>
</div>
</div>
<p>Create dataframes containing capacity factors for the considered nodes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CF_wind</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">CF_solar</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)):</span>
    <span class="n">CF_wind</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_onshorewind</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]][[</span><span class="n">hour</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%SZ&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">hour</span> <span class="ow">in</span> <span class="n">n</span><span class="o">.</span><span class="n">snapshots</span><span class="p">]]</span>
    <span class="n">CF_solar</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_solar</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]][[</span><span class="n">hour</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%SZ&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">hour</span> <span class="ow">in</span> <span class="n">n</span><span class="o">.</span><span class="n">snapshots</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>Add generators to each node:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">.</span><span class="n">madd</span><span class="p">(</span><span class="s2">&quot;Generator&quot;</span><span class="p">,</span>
        <span class="n">nodes</span> <span class="o">+</span> <span class="s2">&quot; onshorewind&quot;</span><span class="p">,</span>
        <span class="n">bus</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span>
        <span class="n">p_nom_extendable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">carrier</span><span class="o">=</span><span class="s2">&quot;onshorewind&quot;</span><span class="p">,</span>
        <span class="c1">#p_nom_max=1000, # maximum capacity can be limited due to environmental constraints</span>
        <span class="n">capital_cost</span> <span class="o">=</span> <span class="n">capital_cost_onshorewind</span><span class="p">,</span>
        <span class="n">marginal_cost</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">p_max_pu</span> <span class="o">=</span> <span class="n">CF_wind</span><span class="p">[</span><span class="n">nodes</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">n</span><span class="o">.</span><span class="n">madd</span><span class="p">(</span><span class="s2">&quot;Generator&quot;</span><span class="p">,</span>
            <span class="n">nodes</span> <span class="o">+</span> <span class="s2">&quot; solar&quot;</span><span class="p">,</span>
            <span class="n">bus</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span>
            <span class="n">p_nom_extendable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">carrier</span><span class="o">=</span><span class="s2">&quot;solar&quot;</span><span class="p">,</span>
            <span class="c1">#p_nom_max=1000, # maximum capacity can be limited due to environmental constraints</span>
            <span class="n">capital_cost</span> <span class="o">=</span> <span class="n">capital_cost_solar</span><span class="p">,</span>
            <span class="n">marginal_cost</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">p_max_pu</span> <span class="o">=</span> <span class="n">CF_solar</span><span class="p">[</span><span class="n">nodes</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">n</span><span class="o">.</span><span class="n">madd</span><span class="p">(</span><span class="s2">&quot;Generator&quot;</span><span class="p">,</span>
            <span class="n">nodes</span> <span class="o">+</span> <span class="s2">&quot; OCGT&quot;</span><span class="p">,</span>
            <span class="n">bus</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span>
            <span class="n">p_nom_extendable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">carrier</span><span class="o">=</span><span class="s2">&quot;gas&quot;</span><span class="p">,</span>
            <span class="c1">#p_nom_max=1000,</span>
            <span class="n">capital_cost</span> <span class="o">=</span> <span class="n">capital_cost_OCGT</span><span class="p">,</span>
            <span class="n">marginal_cost</span> <span class="o">=</span> <span class="n">marginal_cost_OCGT</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;DNK OCGT&#39;, &#39;NOR OCGT&#39;, &#39;SWE OCGT&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Add H2 stores to each node:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Carrier&quot;</span><span class="p">,</span>
      <span class="s2">&quot;H2&quot;</span><span class="p">)</span>

<span class="n">n</span><span class="o">.</span><span class="n">madd</span><span class="p">(</span><span class="s2">&quot;Bus&quot;</span><span class="p">,</span>
            <span class="n">nodes</span> <span class="o">+</span> <span class="s2">&quot; H2&quot;</span><span class="p">,</span>
            <span class="n">location</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">,</span>
            <span class="n">carrier</span> <span class="o">=</span> <span class="s2">&quot;H2&quot;</span><span class="p">)</span>

<span class="n">n</span><span class="o">.</span><span class="n">madd</span><span class="p">(</span><span class="s2">&quot;Store&quot;</span><span class="p">,</span>
             <span class="n">nodes</span> <span class="o">+</span> <span class="s2">&quot; H2 Tank&quot;</span><span class="p">,</span>
             <span class="n">bus</span> <span class="o">=</span> <span class="n">nodes</span> <span class="o">+</span> <span class="s2">&quot; H2&quot;</span><span class="p">,</span>
             <span class="n">e_nom_extendable</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">e_cyclic</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">capital_cost</span> <span class="o">=</span> <span class="n">annuity</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">)</span><span class="o">*</span><span class="mi">57000</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.011</span><span class="p">))</span>

<span class="n">n</span><span class="o">.</span><span class="n">madd</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span>
      <span class="n">nodes</span> <span class="o">+</span> <span class="s2">&quot; H2 Electrolysis&quot;</span><span class="p">,</span>
      <span class="n">bus0</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">,</span>
      <span class="n">bus1</span> <span class="o">=</span> <span class="n">nodes</span> <span class="o">+</span> <span class="s2">&quot; H2&quot;</span><span class="p">,</span>
      <span class="n">p_nom_extendable</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
      <span class="n">efficiency</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
      <span class="n">capital_cost</span> <span class="o">=</span> <span class="n">annuity</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">)</span><span class="o">*</span><span class="mi">600000</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.05</span><span class="p">))</span>

<span class="c1">#Add the link &quot;H2 Fuel Cell&quot; that transports energy from the H2 bus (bus0) to the electricity bus (bus1)</span>
<span class="c1">#with 58% efficiency</span>
<span class="n">n</span><span class="o">.</span><span class="n">madd</span><span class="p">(</span><span class="s2">&quot;Link&quot;</span><span class="p">,</span>
      <span class="n">nodes</span> <span class="o">+</span> <span class="s2">&quot; H2 Fuel Cell&quot;</span><span class="p">,</span>
      <span class="n">bus0</span> <span class="o">=</span> <span class="n">nodes</span> <span class="o">+</span> <span class="s2">&quot; H2&quot;</span><span class="p">,</span>
      <span class="n">bus1</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">,</span>
      <span class="n">p_nom_extendable</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
      <span class="n">efficiency</span> <span class="o">=</span> <span class="mf">0.58</span><span class="p">,</span>
      <span class="n">capital_cost</span> <span class="o">=</span> <span class="n">annuity</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">)</span><span class="o">*</span><span class="mi">1300000</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.05</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;DNK H2 Fuel Cell&#39;, &#39;NOR H2 Fuel Cell&#39;, &#39;SWE H2 Fuel Cell&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>CO2 limit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_limit</span><span class="o">=</span><span class="mi">0</span> <span class="c1">#tonCO2</span>
<span class="n">n</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;GlobalConstraint&quot;</span><span class="p">,</span>
        <span class="s2">&quot;co2_limit&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;primary_energy&quot;</span><span class="p">,</span>
        <span class="n">carrier_attribute</span><span class="o">=</span><span class="s2">&quot;co2_emissions&quot;</span><span class="p">,</span>
        <span class="n">sense</span><span class="o">=</span><span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span>
        <span class="n">constant</span><span class="o">=</span><span class="n">co2_limit</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Solve the network:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">.</span><span class="n">lopf</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span>
             <span class="n">pyomo</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">solver_name</span><span class="o">=</span><span class="s1">&#39;gurobi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_5015/1741158332.py:1: DeprecatedWarning: lopf is deprecated as of 0.24 and will be removed in 1.0. Use linopy-based function ``n.optimize()`` instead. Migrate extra functionalities: https://pypsa.readthedocs.io/en/latest/examples/optimization-with-linopy-migrate-extra-functionalities.html.
  n.lopf(n.snapshots,
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 7.31s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Read LP format model from file /tmp/pypsa-problem-ddcvjdnh.lp
Reading time = 2.94 seconds
obj: 446761 rows, 210262 columns, 933936 nonzeros
Gurobi Optimizer version 10.0.3 build v10.0.3rc0 (linux64)

CPU model: Intel(R) Core(TM) i7-8550U CPU @ 1.80GHz, instruction set [SSE2|AVX|AVX2]
Thread count: 1 physical cores, 1 logical processors, using up to 1 threads

Optimize a model with 446761 rows, 210262 columns and 933936 nonzeros
Model fingerprint: 0xc4448900
Coefficient statistics:
  Matrix range     [1e-03, 1e+00]
  Objective range  [1e+00, 2e+05]
  Bounds range     [0e+00, 0e+00]
  RHS range        [2e+03, 2e+04]
Presolve removed 248665 rows and 82228 columns
Presolve time: 2.45s
Presolved: 198096 rows, 128034 columns, 705964 nonzeros

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0    0.0000000e+00   5.293832e+08   0.000000e+00      5s
   12996    6.9698979e+09   3.192422e+10   0.000000e+00     10s
   18562    7.0042888e+09   3.647654e+10   0.000000e+00     15s
   23620    1.2576115e+10   5.677961e+09   0.000000e+00     20s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Plotting</span> <span class="kn">import</span> <span class="n">plot_map</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tech_colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;onshore wind&#39;</span><span class="p">:</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
              <span class="s1">&#39;solar PV&#39;</span><span class="p">:</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
              <span class="s1">&#39;gas&#39;</span><span class="p">:</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span>
              <span class="s1">&#39;H2&#39;</span><span class="p">:</span><span class="s1">&#39;pink&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_map</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">tech_colors</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">components</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;generators&quot;</span><span class="p">],</span>
             <span class="n">bus_size_factor</span><span class="o">=</span><span class="mf">5e5</span><span class="p">,</span> <span class="n">transmission</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_map</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">tech_colors</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">components</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;stores&quot;</span><span class="p">],</span>
             <span class="n">bus_size_factor</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">transmission</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/57942962407ee02e8ac49088467e9b8133ed9eacba765e6591cab36e5bb3a122.png" src="../_images/57942962407ee02e8ac49088467e9b8133ed9eacba765e6591cab36e5bb3a122.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./course_project"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../Problems/Problem03.02.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Problem 3.2</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Course project</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#project-instructions">PROJECT INSTRUCTIONS</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hints">Hints</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Marta Victoria
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>